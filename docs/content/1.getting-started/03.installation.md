---
title: Installation
description: Production-ready Heimdall deployment
navigation:
  icon: i-lucide-download
---

Complete installation guide for production Heimdall deployments with external database, secrets management, ingress, and TLS.

## Prerequisites

- Kubernetes 1.23+ cluster
- Helm 3.12+ installed
- kubectl configured
- cert-manager (for automated TLS) OR existing TLS certificates
- Ingress controller (Traefik, Nginx, etc.)

## Installation Steps

### 1. Add Helm Repository

```bash
helm repo add mitre https://mitre.github.io/heimdall-helm
helm repo update
```

### 2. Create Namespace

```bash
kubectl create namespace heimdall
```

### 3. Configure Secrets

Choose one approach:

**Option A: External Secrets Operator** (Recommended)

```yaml
# external-secret.yaml
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: heimdall-secrets
  namespace: heimdall
spec:
  secretStoreRef:
    name: aws-secrets-manager
    kind: ClusterSecretStore
  target:
    name: heimdall-production-secrets
  data:
    - secretKey: JWT_SECRET
      remoteRef:
        key: heimdall/production
        property: jwt_secret
    - secretKey: API_KEY_SECRET
      remoteRef:
        key: heimdall/production
        property: api_key_secret
    - secretKey: DATABASE_PASSWORD
      remoteRef:
        key: heimdall/production
        property: database_password
    - secretKey: ADMIN_PASSWORD
      remoteRef:
        key: heimdall/production
        property: admin_password
```

```bash
kubectl apply -f external-secret.yaml
```

**Option B: Manual Secret Creation**

```bash
kubectl create secret generic heimdall-production-secrets \
  --namespace heimdall \
  --from-literal=JWT_SECRET="$(openssl rand -hex 64)" \
  --from-literal=API_KEY_SECRET="$(openssl rand -hex 33)" \
  --from-literal=DATABASE_PASSWORD="$(openssl rand -hex 33)" \
  --from-literal=ADMIN_PASSWORD="SecurePassword123!"
```

### 4. Create Values File

```yaml
# heimdall-production.yaml
heimdall:
  # Use existing secret
  existingSecret: "heimdall-production-secrets"

  # Replica count for HA
  replicaCount: 2

  # Resource limits
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi

  # Ingress configuration
  ingress:
    enabled: true
    className: "traefik"
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
    hosts:
      - host: heimdall.example.com
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: heimdall-tls
        hosts:
          - heimdall.example.com

  # High availability
  podDisruptionBudget:
    enabled: true
    minAvailable: 1

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70

# PostgreSQL configuration
postgresql:
  enabled: true
  auth:
    database: heimdall_production
    username: heimdall
  primary:
    resources:
      requests:
        cpu: 250m
        memory: 256Mi
    persistence:
      size: 20Gi
      storageClass: "gp3"  # AWS EBS gp3
```

### 5. Install Heimdall

```bash
helm install heimdall mitre/heimdall \
  --namespace heimdall \
  --values heimdall-production.yaml \
  --wait
```

### 6. Verify Installation

```bash
# Check pods
kubectl get pods -n heimdall

# Check ingress
kubectl get ingress -n heimdall

# Check certificate (if using cert-manager)
kubectl get certificate -n heimdall
```

Expected output:
```
NAME                         READY   STATUS    RESTARTS   AGE
heimdall-0                   1/1     Running   0          2m
heimdall-1                   1/1     Running   0          2m
heimdall-postgresql-0        1/1     Running   0          2m
```

### 7. Access Heimdall

Open https://heimdall.example.com (replace with your domain)

Login with admin credentials from secrets.

## External Database Setup

To use AWS RDS, GCP Cloud SQL, or Azure Database instead of embedded PostgreSQL:

```yaml
# heimdall-production.yaml
heimdall:
  existingSecret: "heimdall-production-secrets"

# Disable embedded PostgreSQL
postgresql:
  enabled: false

# Configure external database
externalDatabase:
  host: "heimdall-db.abc123.us-east-1.rds.amazonaws.com"
  port: 5432
  database: "heimdall_production"
  username: "heimdall"
  # Password comes from existingSecret (DATABASE_PASSWORD key)
```

## Common Configurations

### With GitHub OAuth

```yaml
heimdall:
  config:
    GITHUB_CLIENTID: "true"
    GITHUB_CLIENTID: "your-github-client-id"
    # Client secret goes in secret (GITHUB_CLIENTSECRET)
```

### With Okta OIDC

```yaml
heimdall:
  config:
    OIDC_NAME: "Okta"
    OIDC_ISSUER: "https://your-org.okta.com"
    OIDC_CLIENTID: "your-okta-client-id"
    # Client secret goes in secret (OIDC_CLIENT_SECRET)
```

### With LDAP

```yaml
heimdall:
  config:
    LDAP_ENABLED: "true"
    LDAP_HOST: "ldap.example.com"
    LDAP_PORT: "636"
    LDAP_BINDDN: "cn=admin,dc=example,dc=com"
    # LDAP password goes in secret (LDAP_PASSWORD)
```

See [Common Scenarios](/getting-started/common-scenarios) for complete examples.

## Troubleshooting

### Pods Not Starting

```bash
kubectl describe pod -n heimdall heimdall-0
kubectl logs -n heimdall heimdall-0
```

### Database Connection Issues

```bash
# Check PostgreSQL pod
kubectl get pods -n heimdall | grep postgresql

# Check PostgreSQL logs
kubectl logs -n heimdall heimdall-postgresql-0
```

### Certificate Not Issued

```bash
# Check certificate status
kubectl describe certificate -n heimdall heimdall-tls

# Check cert-manager logs
kubectl logs -n cert-manager deploy/cert-manager
```

## Next Steps

::card-group
  ::card{icon="i-lucide-shield-check" title="Authentication" to="/configuration/authentication"}
  Configure GitHub, GitLab, Okta, LDAP
  ::
  ::card{icon="i-lucide-database" title="Database" to="/getting-started/database"}
  External database setup
  ::
  ::card{icon="i-lucide-lock" title="TLS/SSL" to="/configuration/tls"}
  HTTPS with cert-manager or manual certs
  ::
::
