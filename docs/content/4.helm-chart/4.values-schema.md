---
title: Values Schema Validation
description: JSON Schema validation for comprehensive configuration validation
navigation:
  icon: i-lucide-file-json
---

The Heimdall Helm chart includes **values.schema.json** for comprehensive configuration validation using JSON Schema Draft-07.

## What is Values Schema?

Helm 3+ supports JSON Schema validation of `values.yaml` files. The schema:

- **Validates data types** (string, boolean, integer, array, object)
- **Enforces required fields** for critical configuration
- **Provides enum constraints** for fields with specific allowed values
- **Includes descriptions** for all configuration options
- **Prevents typos** in configuration keys

::tip
Schema validation runs automatically during `helm install`, `helm upgrade`, `helm lint`, and `helm template`.
::

## Validation Scope

The schema validates **95+ environment variables** across these categories:

### Core Application Settings

::field-group
  ::field{name="nodeEnv" type="string"}
  Node.js environment (enum: `development`, `production`)
  ::
  ::field{name="adminEmail" type="string"}
  Admin user email address (format: email)
  ::
  ::field{name="jwtExpireTime" type="string"}
  JWT token expiration time
  ::
::

### Database Configuration

::field-group
  ::field{name="databaseHost" type="string"}
  PostgreSQL server hostname
  ::
  ::field{name="databasePort" type="integer"}
  PostgreSQL server port (default: 5432)
  ::
  ::field{name="databaseName" type="string"}
  Database name
  ::
  ::field{name="databaseUsername" type="string"}
  Database username
  ::
  ::field{name="databaseSsl" type="boolean"}
  Enable SSL for database connection
  ::
::

### Authentication Providers

LDAP configuration:

::field-group
  ::field{name="ldapEnabled" type="boolean"}
  Enable LDAP authentication
  ::
  ::field{name="ldapHost" type="string"}
  LDAP server hostname
  ::
  ::field{name="ldapPort" type="integer"}
  LDAP server port (default: 389)
  ::
  ::field{name="ldapSsl" type="boolean"}
  Use SSL for LDAP connection
  ::
::

OAuth providers (GitHub, GitLab, Google):

::field-group
  ::field{name="githubClientId" type="string"}
  GitHub OAuth client ID
  ::
  ::field{name="gitlabClientId" type="string"}
  GitLab OAuth client ID
  ::
  ::field{name="googleClientId" type="string"}
  Google OAuth client ID
  ::
::

OIDC configuration:

::field-group
  ::field{name="oidcName" type="string"}
  OIDC provider display name
  ::
  ::field{name="oidcIssuer" type="string"}
  OIDC issuer URL
  ::
  ::field{name="oidcUsesVerifiedEmail" type="boolean"}
  Require verified email (default: true)
  ::
::

## Schema Structure

The schema follows this pattern:

```json [values.schema.json]
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "nodeEnv": {
      "type": "string",
      "enum": ["development", "production"],
      "description": "Node.js runtime environment"
    },
    "adminEmail": {
      "type": "string",
      "format": "email",
      "description": "Administrator email address"
    },
    "databasePort": {
      "type": "integer",
      "minimum": 1,
      "maximum": 65535,
      "description": "PostgreSQL server port"
    },
    "ldapEnabled": {
      "type": "boolean",
      "description": "Enable LDAP authentication"
    }
  }
}
```

## Validation Examples

### Successful Validation

```bash [Terminal]
helm lint ./heimdall --strict
```

```
==> Linting ./heimdall
[INFO] Chart.yaml: icon is recommended
1 chart(s) linted, 0 chart(s) failed
```

### Type Mismatch Error

```yaml [values.yaml]
databasePort: "5432"  # String instead of integer
```

```bash [Terminal]
helm install heimdall ./heimdall
```

```
Error: values don't meet the specifications of the schema(s):
- databasePort: Invalid type. Expected: integer, given: string
```

### Enum Constraint Error

```yaml [values.yaml]
nodeEnv: "staging"  # Not in allowed values
```

```
Error: values don't meet the specifications of the schema(s):
- nodeEnv: nodeEnv must be one of the following: "development", "production"
```

### Email Format Error

```yaml [values.yaml]
adminEmail: "not-an-email"
```

```
Error: values don't meet the specifications of the schema(s):
- adminEmail: Does not match format 'email'
```

## Bypassing Validation

For air-gapped environments or testing, skip schema validation:

```bash [Terminal]
helm install heimdall ./heimdall --skip-schema-validation
```

::warning
Only use `--skip-schema-validation` when absolutely necessary. Schema validation prevents common configuration errors.
::

## Schema Benefits

### 1. Early Error Detection

Catch configuration errors **before deployment**:

```bash [Terminal]
# Validate locally before deploying
helm lint ./heimdall --strict

# Dry-run with validation
helm install heimdall ./heimdall --dry-run --debug
```

### 2. Type Safety

Prevent type mismatches:

```yaml
# ❌ Wrong - String instead of boolean
ldapEnabled: "true"

# ✅ Correct - Boolean value
ldapEnabled: true
```

### 3. Documentation

The schema serves as **machine-readable documentation**:

```bash [Terminal]
# View schema documentation
cat heimdall/values.schema.json | jq '.properties.ldapEnabled'
```

```json
{
  "type": "boolean",
  "description": "Enable LDAP authentication for user login"
}
```

### 4. IDE Integration

Modern IDEs can use the schema for **autocomplete and validation**:

- **VS Code**: YAML extension provides inline validation
- **IntelliJ IDEA**: Built-in JSON Schema support
- **Vim**: ALE and coc.nvim plugins

## Template Helpers and Schema

The schema complements template helpers in `_helpers.tpl`:

```yaml [templates/_helpers.tpl]
{{- define "heimdall.databaseHost" -}}
{{- if .Values.postgresql.enabled -}}
{{ include "postgresql.v1.primary.fullname" .Subcharts.postgresql }}
{{- else -}}
{{ .Values.externalDatabase.host }}
{{- end -}}
{{- end -}}
```

While schema validates **input values**, template helpers provide **computed values** based on configuration.

## Future Enhancements

Potential schema improvements:

- **Conditional validation** - Require LDAP fields only when `ldapEnabled: true`
- **Pattern validation** - URL format for issuer URLs
- **Cross-field validation** - Ensure database credentials match deployment mode
- **Default value documentation** - Include defaults in schema descriptions

## Next Steps

::card-group
  ::card{icon="i-lucide-code" title="Template Helpers" to="/helm-chart/helpers"}
  Learn about database abstraction helpers
  ::
  ::card{icon="i-lucide-settings" title="Configuration" to="/helm-chart/configuration"}
  Explore environment variables
  ::
::
