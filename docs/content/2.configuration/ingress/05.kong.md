---
title: Kong Ingress Controller
description: Setup and configure Kong for Heimdall with API gateway features
navigation:
  icon: i-lucide-unplug
---

Kong Gateway offers both open-source and enterprise editions with API gateway features.

## Installation

### 1. Add Kong Helm Repository

```bash
helm repo add kong https://charts.konghq.com
helm repo update
```

### 2. Install Kong

```bash
helm install kong kong/kong -n kong --create-namespace \
  --set ingressController.installCRDs=false
```

### 3. Verify Installation

```bash
kubectl get pods -n kong
```

Expected output showing Kong controller and gateway pods running.

## Basic Configuration

```yaml
heimdall:
  ingress:
    enabled: true
    className: "kong"
    annotations:
      konghq.com/strip-path: "false"
      konghq.com/preserve-host: "true"

    hosts:
      - host: heimdall.example.com
        paths:
          - path: /
            pathType: Prefix
```

## Kong Plugins

Kong's power comes from plugins. Apply them via annotations.

### Rate Limiting

Create KongPlugin:

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: rate-limiting
  namespace: heimdall
config:
  minute: 100
  policy: local
plugin: rate-limiting
```

Apply:
```bash
kubectl apply -f rate-limiting-plugin.yaml
```

Use in ingress:
```yaml
heimdall:
  ingress:
    annotations:
      konghq.com/plugins: rate-limiting
```

### CORS

Create CORS plugin:

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: cors
  namespace: heimdall
config:
  origins:
    - "https://example.com"
  methods:
    - GET
    - POST
    - PUT
    - DELETE
  headers:
    - Authorization
    - Content-Type
  exposed_headers:
    - X-Auth-Token
  credentials: true
  max_age: 3600
plugin: cors
```

### Request Transformer

Modify headers, query params, or body:

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: request-transformer
  namespace: heimdall
config:
  add:
    headers:
      - "X-Forwarded-Host: heimdall.example.com"
plugin: request-transformer
```

### IP Restriction

Whitelist/blacklist IPs:

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: ip-restriction
  namespace: heimdall
config:
  allow:
    - "192.168.1.0/24"
    - "10.0.0.0/8"
plugin: ip-restriction
```

## Complete Example

Full configuration with multiple plugins:

```yaml
heimdall:
  ingress:
    enabled: true
    className: "kong"
    annotations:
      # Multiple plugins (comma-separated)
      konghq.com/plugins: rate-limiting,cors,ip-restriction

      # Path handling
      konghq.com/strip-path: "false"
      konghq.com/preserve-host: "true"

      # HTTPS redirect
      konghq.com/protocols: "https"
      konghq.com/https-redirect-status-code: "301"

    hosts:
      - host: heimdall.example.com
        paths:
          - path: /
            pathType: Prefix

    tls:
      - secretName: heimdall-tls
        hosts:
          - heimdall.example.com
```

## Enterprise Features

Kong Enterprise adds:
- **Developer Portal** - API documentation
- **Kong Manager** - GUI for configuration
- **Advanced Analytics** - Request metrics and monitoring
- **RBAC** - Role-based access control
- **Workspaces** - Multi-tenancy

## Common Annotations

```yaml
annotations:
  # Protocols
  konghq.com/protocols: "https"
  konghq.com/https-redirect-status-code: "301"

  # Path handling
  konghq.com/strip-path: "false"
  konghq.com/preserve-host: "true"

  # Timeout
  konghq.com/connect-timeout: "60000"
  konghq.com/read-timeout: "600000"
  konghq.com/write-timeout: "600000"

  # Plugins
  konghq.com/plugins: "plugin1,plugin2,plugin3"
```

## Authentication Plugins

### Basic Auth

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: basic-auth
  namespace: heimdall
config:
  hide_credentials: true
plugin: basic-auth
```

Create credential:
```yaml
apiVersion: configuration.konghq.com/v1
kind: KongConsumer
metadata:
  name: admin
  namespace: heimdall
username: admin
---
apiVersion: v1
kind: Secret
metadata:
  name: admin-basic-auth
  namespace: heimdall
stringData:
  kongCredType: basic-auth
  username: admin
  password: secure-password
```

### Key Auth

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: key-auth
  namespace: heimdall
config:
  key_names:
    - apikey
plugin: key-auth
```

## Performance Plugins

### Response Caching

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: proxy-cache
  namespace: heimdall
config:
  strategy: memory
  content_type:
    - "application/json"
  cache_ttl: 300
plugin: proxy-cache
```

### Compression

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: gzip
  namespace: heimdall
plugin: gzip
```

## Security Plugins

### Bot Detection

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: bot-detection
  namespace: heimdall
config:
  allow:
    - "Googlebot"
    - "Bingbot"
  deny:
    - "BadBot"
plugin: bot-detection
```

### Request Size Limiting

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: request-size-limiting
  namespace: heimdall
config:
  allowed_payload_size: 100  # MB
plugin: request-size-limiting
```

## Kong Manager Dashboard

Access Kong Manager (if using Kong Enterprise):

```bash
kubectl port-forward -n kong svc/kong-kong-manager 8002:8002
```

Open: http://localhost:8002

## Common Issues

### Plugin Not Applied

Check plugin exists:
```bash
kubectl get kongplugin -n heimdall
```

Check annotation matches plugin name:
```yaml
annotations:
  konghq.com/plugins: "exact-plugin-name"
```

### 404 Not Found

Verify Kong is routing traffic:
```bash
kubectl logs -n kong -l app.kubernetes.io/name=kong
```

Check ingress configuration:
```bash
kubectl describe ingress -n heimdall
```

## See Also

- [Ingress Overview](/helm-chart/configuration/ingress/overview) - Compare ingress controllers
- [TLS Configuration](/helm-chart/configuration/tls/overview) - HTTPS setup
- [Ingress Troubleshooting](/helm-chart/configuration/ingress/troubleshooting) - Common issues
- [Kong Documentation](https://docs.konghq.com/) - Official docs
