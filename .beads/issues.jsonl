{"id":"heimdall-helm-07c","title":"Create data migration strategy: Standalone PostgreSQL StatefulSet → Bitnami subchart","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T12:02:25.13522-05:00","created_by":"alippold","updated_at":"2025-12-31T00:20:54.564091-05:00","closed_at":"2025-12-31T00:20:54.564091-05:00","close_reason":"No longer relevant - migration job removed, using app-based migrations","dependencies":[{"issue_id":"heimdall-helm-07c","depends_on_id":"heimdall-helm-alv","type":"blocks","created_at":"2025-12-30T12:03:05.642679-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-07f","title":"Phase 7: CI/CD \u0026 Release - GitHub Actions, v1.0.0","status":"open","priority":0,"issue_type":"epic","created_at":"2025-12-30T11:39:30.651049-05:00","created_by":"alippold","updated_at":"2025-12-30T12:20:54.182954-05:00","dependencies":[{"issue_id":"heimdall-helm-07f","depends_on_id":"heimdall-helm-pp6","type":"blocks","created_at":"2025-12-30T11:56:36.392306-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-0he","title":"CRITICAL: Debug Issue #13 - StatefulSet PVC reconnection (already uses StatefulSet!)","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-30T12:02:08.415094-05:00","created_by":"alippold","updated_at":"2025-12-31T00:20:54.569387-05:00","closed_at":"2025-12-31T00:20:54.569387-05:00","close_reason":"No longer relevant - migration job removed, using app-based migrations","dependencies":[{"issue_id":"heimdall-helm-0he","depends_on_id":"heimdall-helm-alv","type":"blocks","created_at":"2025-12-30T12:02:48.257816-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-2k8","title":"Phase 3: Health \u0026 HA - Probes, PDB, HPA","status":"open","priority":0,"issue_type":"epic","created_at":"2025-12-30T11:39:10.771934-05:00","created_by":"alippold","updated_at":"2025-12-30T12:20:31.10491-05:00","dependencies":[{"issue_id":"heimdall-helm-2k8","depends_on_id":"heimdall-helm-alv","type":"blocks","created_at":"2025-12-30T11:56:17.343494-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-2k8.1","title":"Add startup probe configuration to StatefulSet","description":"Implement startup probe for Heimdall to handle slow initial startup with database migrations. Use /api/v1/health endpoint. Configure appropriate failureThreshold and periodSeconds.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-31T09:44:42.961989-05:00","created_by":"alippold","updated_at":"2025-12-31T09:47:40.550519-05:00","closed_at":"2025-12-31T09:47:40.550519-05:00","close_reason":"Completed: Added database readiness init container (pg_isready) and startup probe. Init container waits for PostgreSQL before Heimdall starts. Startup probe allows 6 minutes for migrations.","dependencies":[{"issue_id":"heimdall-helm-2k8.1","depends_on_id":"heimdall-helm-2k8","type":"parent-child","created_at":"2025-12-31T09:44:42.963117-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-2k8.2","title":"Add database readiness init container (pg_isready)","description":"Add init container to wait for PostgreSQL before starting Heimdall. Use pg_isready command. Already done for db-migrate-job, apply same pattern to StatefulSet.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-31T09:44:50.513757-05:00","created_by":"alippold","updated_at":"2025-12-31T09:47:40.547229-05:00","closed_at":"2025-12-31T09:47:40.547229-05:00","close_reason":"Completed: Added database readiness init container (pg_isready) and startup probe. Init container waits for PostgreSQL before Heimdall starts. Startup probe allows 6 minutes for migrations.","dependencies":[{"issue_id":"heimdall-helm-2k8.2","depends_on_id":"heimdall-helm-2k8","type":"parent-child","created_at":"2025-12-31T09:44:50.518672-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-2k8.3","title":"Optimize liveness and readiness probe endpoints","description":"Update probes to use proper health endpoints instead of root path. Verify /api/v1/health or similar exists. Optimize initialDelaySeconds, periodSeconds based on actual startup time.","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-31T09:44:59.193617-05:00","created_by":"alippold","updated_at":"2025-12-31T09:44:59.193617-05:00","dependencies":[{"issue_id":"heimdall-helm-2k8.3","depends_on_id":"heimdall-helm-2k8","type":"parent-child","created_at":"2025-12-31T09:44:59.199074-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-2k8.4","title":"Add PodDisruptionBudget template","description":"Create PodDisruptionBudget template to prevent disruptions during updates. Default: minAvailable=1. Reference Vulcan pattern.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-31T09:45:07.323473-05:00","created_by":"alippold","updated_at":"2025-12-31T09:50:23.33482-05:00","closed_at":"2025-12-31T09:50:23.33482-05:00","close_reason":"Completed: Added PodDisruptionBudget and HorizontalPodAutoscaler templates. Both disabled by default. PDB ensures availability during disruptions, HPA scales based on CPU/memory.","dependencies":[{"issue_id":"heimdall-helm-2k8.4","depends_on_id":"heimdall-helm-2k8","type":"parent-child","created_at":"2025-12-31T09:45:07.324526-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-2k8.5","title":"Add HorizontalPodAutoscaler template","description":"Create HPA template for auto-scaling based on CPU/memory. Default: disabled. Min replicas: 1, Max: 3, Target CPU: 80%.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-31T09:45:16.416248-05:00","created_by":"alippold","updated_at":"2025-12-31T09:50:23.337258-05:00","closed_at":"2025-12-31T09:50:23.337258-05:00","close_reason":"Completed: Added PodDisruptionBudget and HorizontalPodAutoscaler templates. Both disabled by default. PDB ensures availability during disruptions, HPA scales based on CPU/memory.","dependencies":[{"issue_id":"heimdall-helm-2k8.5","depends_on_id":"heimdall-helm-2k8","type":"parent-child","created_at":"2025-12-31T09:45:16.420714-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-2k8.6","title":"Document health probe configuration and tuning","description":"Create documentation page explaining startup/liveness/readiness probes, PDB, HPA. Include tuning guide for different deployment sizes.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-31T09:45:21.879337-05:00","created_by":"alippold","updated_at":"2025-12-31T09:45:21.879337-05:00","dependencies":[{"issue_id":"heimdall-helm-2k8.6","depends_on_id":"heimdall-helm-2k8","type":"parent-child","created_at":"2025-12-31T09:45:21.884226-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-386","title":"Fix GitHub Issue #7542: GitLab/OIDC redirect_uri duplicates externalUrl","description":"BUG: redirect_uri malformed - externalUrl concatenated twice\nExpected: https://example.com/authn/oidc_callback\nActual: https://example.com/authn/https://example.com/authn/oidc_callback\n\nRoot cause: IN HEIMDALL2 APPLICATION CODE (not Helm chart)\nChart only sets EXTERNAL_URL env var - app constructs callback URLs\n\nACTION PLAN:\n1. Chart: Document proper externalUrl format, add validation in values.schema.json ✅\n2. App fix: Separate PR to mitre/heimdall2 repository\n   - Need fresh clone or new branch off main\n   - File location: apps/backend/src/auth/* (likely passport strategies)\n   - Callback URL construction logic needs fix\n\nAffects: GitLab OAuth, OIDC authentication\nFiled by: @jwuebbl on 2025-12-30\nIssue: https://github.com/mitre/heimdall2/issues/7542\n\nDEFERRED: Application fix will be separate workstream after chart modernization","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-30T12:49:22.465906-05:00","created_by":"alippold","updated_at":"2025-12-30T12:52:21.919302-05:00","dependencies":[{"issue_id":"heimdall-helm-386","depends_on_id":"heimdall-helm-7ww","type":"blocks","created_at":"2025-12-30T12:49:49.237177-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-6d3","title":"Fix GitHub Issue #33: CA certificate filename hardcoded to certs.pem","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T11:39:37.051581-05:00","created_by":"alippold","updated_at":"2025-12-30T11:39:37.051581-05:00","dependencies":[{"issue_id":"heimdall-helm-6d3","depends_on_id":"heimdall-helm-8yk","type":"blocks","created_at":"2025-12-30T11:57:14.311381-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-6rg","title":"Custom CA Certificates - Simplify and Standardize","description":"Simplify certificate injection to match Vulcan pattern\nRemove complex UBI8 init container approach\nUse NODE_EXTRA_CA_CERTS for Node.js applications\n\nCurrent Issues:\n- heimdall-helm-6d3: CA certificate filename hardcoded\n- Overly complex systemCertsApproach with UBI8 dependency\n\nNew Approach:\n- extraCertificates.enabled\n- extraCertificates.configMapName (reference existing)\n- extraCertificates.certificates (inline)\n- Use NODE_EXTRA_CA_CERTS environment variable\n\nUse Case: Corporate MITM proxies, internal APIs with custom CA\n\nReference: INGRESS-TLS-RESEARCH.md section 3","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-31T00:22:12.856066-05:00","created_by":"alippold","updated_at":"2025-12-31T00:22:12.856066-05:00"}
{"id":"heimdall-helm-6rg.1","title":"Refactor values.yaml certs section to extraCertificates","description":"PARTIAL IMPLEMENTATION - Needs review next session\n\nCOMPLETED:\n- Refactored values.yaml: certs → extraCertificates (simpler pattern)\n- Updated ConfigMap template for new structure\n- Updated StatefulSet to use NODE_EXTRA_CA_CERTS\n\nISSUE DISCOVERED:\n- NODE_EXTRA_CA_CERTS expects FILE path, not DIRECTORY\n- We're mounting ConfigMap with MULTIPLE certificate files\n- Need to research: concatenate to single file vs use SSL_CERT_DIR\n\nNEXT SESSION ACTIONS:\n1. Research Node.js certificate handling (file vs directory)\n2. Look at real-world examples (Vulcan, other charts)\n3. Decide: single concatenated file OR directory approach\n4. Test with actual corporate CA certificates\n5. Document the approach\n\nFILES CHANGED (uncommitted):\n- heimdall/values.yaml (extraCertificates structure)\n- heimdall/templates/heimdall-cacerts-configmap.yaml\n- heimdall/templates/heimdall-statefulset.yaml\n\nChart currently LINTS SUCCESSFULLY but implementation needs deeper review.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:22:32.118054-05:00","created_by":"alippold","updated_at":"2025-12-31T00:49:08.133938-05:00","closed_at":"2025-12-31T00:49:08.133938-05:00","close_reason":"Completed: Refactored extraCertificates with init container concatenation approach. NODE_EXTRA_CA_CERTS now points to single ca-bundle.pem file. Chart lints successfully.","dependencies":[{"issue_id":"heimdall-helm-6rg.1","depends_on_id":"heimdall-helm-6rg","type":"parent-child","created_at":"2025-12-31T00:22:32.122941-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-6rg.2","title":"Implement NODE_EXTRA_CA_CERTS certificate injection","description":"NEEDS RESEARCH: NODE_EXTRA_CA_CERTS implementation requires review of file vs directory approach. See parent task heimdall-helm-6rg.1 for details.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:22:32.211193-05:00","created_by":"alippold","updated_at":"2025-12-31T00:49:08.164685-05:00","closed_at":"2025-12-31T00:49:08.164685-05:00","close_reason":"Completed: Refactored extraCertificates with init container concatenation approach. NODE_EXTRA_CA_CERTS now points to single ca-bundle.pem file. Chart lints successfully.","dependencies":[{"issue_id":"heimdall-helm-6rg.2","depends_on_id":"heimdall-helm-6rg","type":"parent-child","created_at":"2025-12-31T00:22:32.212301-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-6rg.3","title":"Document corporate proxy MITM use case","description":"Add documentation for:\n- When extraCertificates is needed\n- Corporate MITM proxy scenario\n- Internal APIs with custom CA\n- How to create ConfigMap from .crt/.pem files\n- Example configurations\n\nReference: INGRESS-TLS-RESEARCH.md section 3","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:22:32.298187-05:00","created_by":"alippold","updated_at":"2025-12-31T00:50:10.09776-05:00","closed_at":"2025-12-31T00:50:10.09776-05:00","close_reason":"Completed: Created comprehensive documentation in 10.custom-ca-certificates.md covering corporate MITM proxies, DoD PKI, internal APIs, private registries, and more.","dependencies":[{"issue_id":"heimdall-helm-6rg.3","depends_on_id":"heimdall-helm-6rg","type":"parent-child","created_at":"2025-12-31T00:22:32.299126-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-6rg.4","title":"Test with corporate CA bundle (MITRE example)","description":"Create test ConfigMap with example corporate CA\nDeploy chart with extraCertificates.enabled=true\nVerify NODE_EXTRA_CA_CERTS is set\nTest Heimdall can connect to internal APIs\nDocument test procedure","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-31T00:22:32.389243-05:00","created_by":"alippold","updated_at":"2025-12-31T00:22:32.389243-05:00","dependencies":[{"issue_id":"heimdall-helm-6rg.4","depends_on_id":"heimdall-helm-6rg","type":"parent-child","created_at":"2025-12-31T00:22:32.390275-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-6rg.5","title":"Close GitHub Issue #33 (filename hardcoded)","description":"Verify heimdall-helm-6d3 is resolved by new extraCertificates approach\nConfigMap supports multiple files with any names\nNo hardcoded 'certs.pem' filename\nClose issue with reference to this epic","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:22:32.499752-05:00","created_by":"alippold","updated_at":"2025-12-31T00:51:00.941626-05:00","closed_at":"2025-12-31T00:51:00.941626-05:00","close_reason":"Completed: Closed GitHub Issue #33. New extraCertificates implementation accepts any .crt/.pem filename and concatenates automatically.","dependencies":[{"issue_id":"heimdall-helm-6rg.5","depends_on_id":"heimdall-helm-6rg","type":"parent-child","created_at":"2025-12-31T00:22:32.500806-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-6w4","title":"Fix GitHub Issue #9: Add Helm tests","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T11:40:04.203201-05:00","created_by":"alippold","updated_at":"2025-12-30T11:40:04.203201-05:00","dependencies":[{"issue_id":"heimdall-helm-6w4","depends_on_id":"heimdall-helm-pp6","type":"blocks","created_at":"2025-12-30T11:57:25.022596-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-6zu","title":"RECOVERY: Current Session Context","description":"Context from 2025-12-30 Session 4:\n\nCOMPLETED THIS SESSION:\n- ✅ Three-approach secrets management (commit 5d1bd84)\n  * heimdall-secrets.yaml template (existingSecret/secretsFiles/inline)\n  * generate-heimdall-secrets.sh script (tested, working)\n  * heimdallconfig.yaml with 95+ environment variables\n  * Updated .gitignore to exclude secrets properly\n- ✅ ConfigMap and StatefulSet refactor (commit dee9ce9)\n  * Created configmap.yaml template\n  * Simplified StatefulSet from 482→168 lines (-314 lines, 65% reduction!)\n  * Replaced individual env entries with envFrom pattern\n  * Helm v4 compatible, follows K8s best practices\n  * helm lint --strict: PASSED\n  * Templates rendering correctly\n\nIN PROGRESS:\n- Phase 1: Foundation (heimdall-helm-boh) - NEARLY COMPLETE\n  * Core functionality done (secrets, ConfigMap, StatefulSet)\n  * Optional remaining: documentation pages, fix issues #6, #22, #24\n\nGIT STATUS:\n- Branch: develop\n- Remote: up to date with origin/develop\n- Last commits:\n  * dee9ce9: ConfigMap + StatefulSet refactor\n  * 5d1bd84: Three-approach secrets\n  * cd1db1c: Nuxt UI docs site\n  * 6c25bd2: values.schema.json + helpers\n- Working tree: CLEAN (only .beads/.bdui/ untracked - safe to ignore)\n\nBEADS STATUS:\n- Total: 27 issues (21 open, 1 in_progress, 5 closed)\n- Phase 1 epic (heimdall-helm-boh): in_progress\n- 0 issues ready (all blocked by Phase 1 dependencies)\n- Phase 0 closed (skipped baseline testing)\n\nKEY TECHNICAL ACHIEVEMENTS:\n- values.schema.json: Validates 95+ environment variables with JSON Schema Draft-07\n- Database helpers in _helpers.tpl: Abstract embedded vs external PostgreSQL\n- envFrom pattern: Loads ConfigMap + Secret in bulk (Kubernetes best practice)\n- Helm v4 compatible: Tested with Helm 4.0.4, uses Server-Side Apply (SSA)\n- Code reduction: -428 lines removed, +185 added = net -243 lines\n\nFILES CREATED/MODIFIED THIS SESSION:\nCreated:\n- heimdall/values.schema.json (574 lines)\n- heimdall/templates/heimdall-secrets.yaml\n- heimdall/templates/configmap.yaml\n- heimdall/env/heimdallconfig.yaml\n- generate-heimdall-secrets.sh\n- docs/ (full Nuxt UI site)\n\nModified:\n- heimdall/templates/_helpers.tpl (+80 lines database helpers)\n- heimdall/templates/heimdall-statefulset.yaml (-314 lines via envFrom)\n- heimdall/values.yaml (added heimdall.existingSecret, heimdall.secrets, etc.)\n- .gitignore (clarified secrets exclusion pattern)\n\nRemoved:\n- heimdall/templates/secrets.yaml (replaced with heimdall-secrets.yaml)\n\nHELM V4 NOTES:\n- Chart is Helm v4 compatible (tested with 4.0.4)\n- Server-Side Apply (SSA) enabled by default in v4\n- No template changes needed for v4 compatibility\n- envFrom pattern fully compatible with v4\n- References:\n  * https://user-cube.medium.com/helm-best-practices-2025-what-changed-with-helm-4-and-what-you-should-know-b6d3065fb6e1\n  * https://medium.com/ape-factory/helm-v4-vs-v3-understanding-the-key-differences-2e120525539c\n\nNEXT STEPS (Phase 1 Completion):\n1. Optional: Create getting-started documentation content\n2. Optional: Fix Issue #6 - duplicate host configuration in ingress\n3. Optional: Update Issue #22 status (values.schema.json already complete)\n4. Optional: Investigate Issue #24 (may be intentional for SOPS)\n5. Close Phase 1 epic when satisfied with foundation\n6. Begin Phase 2: Database \u0026 Persistence (Bitnami PostgreSQL integration)\n\nPHASE 2 PREVIEW:\n- Integrate Bitnami PostgreSQL subchart (like Vulcan)\n- Create database migration job (Helm hooks)\n- Add init containers for database readiness checks\n- Support external database configuration\n- Add volumeClaimTemplates for persistent storage\n\nCRITICAL PATTERNS LEARNED:\n- NEVER guess - always read official documentation first\n- Use MCPs (nuxt-ui-remote, github, context7) for accurate info\n- Follow template patterns exactly from reference implementations\n- Beads workflow: ONE command at a time (CLI bug when chained)\n- Helm v4: Charts remain compatible, engine improvements automatic\n\nREFERENCE DOCUMENTATION:\n- Vulcan chart: /Users/alippold/github/mitre/vulcan-helm\n- HEIMDALL-MIGRATION-PLAN.md - Complete modernization strategy\n- ISSUES-ANALYSIS.md - Analysis of 8 GitHub issues\n- Helm best practices: https://helm.sh/docs/chart_best_practices/\n- Nuxt UI template: https://github.com/nuxt-ui-templates/docs\n\nMODEL: Sonnet 4.5\nCONTEXT: 82% used before compact (164k/200k tokens)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T16:39:28.873572-05:00","created_by":"alippold","updated_at":"2025-12-30T16:53:36.350711-05:00","closed_at":"2025-12-30T16:53:36.350711-05:00","close_reason":"Context restored after compact. Ready to continue Phase 2 work."}
{"id":"heimdall-helm-7ww","title":"Phase 5: OAuth/OIDC Fix - GitLab authentication debug","status":"open","priority":0,"issue_type":"epic","created_at":"2025-12-30T11:39:21.085562-05:00","created_by":"alippold","updated_at":"2025-12-30T12:20:42.609522-05:00","dependencies":[{"issue_id":"heimdall-helm-7ww","depends_on_id":"heimdall-helm-8yk","type":"blocks","created_at":"2025-12-30T11:56:26.42256-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-82b","title":"RECOVERY: Current Session Context","description":"Context from 2025-12-30 Session 2:\n\nCOMPLETED THIS SESSION:\n- ✅ Established proper dependency chain (24 tasks with sequential phases)\n- ✅ Added 8 critical tasks from Plan agent comprehensive review\n- ✅ Created .gitignore and .helmignore files (Helm best practices)\n- ✅ Renamed chart directory: heimdall2/ → heimdall/ (git mv, history preserved)\n- ✅ Updated all documentation references (README, CLAUDE.md, PROJECT-STATUS.md)\n- ✅ Committed and pushed all changes to develop branch\n\nCRITICAL FINDING - PERSISTENCE BUG DISCOVERED:\n- PostgreSQL StatefulSet uses STATIC PVC reference (line 86: claimName)\n- ❌ WRONG: Should use volumeClaimTemplates for StatefulSet\n- ❌ ROOT CAUSE of Issue #13 (PV doesn't reconnect on redeploy)\n- Heimdall StatefulSet uses emptyDir (ephemeral - data lost on restart)\n- User reported: \"persistence may be backward - DB vs App\"\n- Files: heimdall/templates/postgresql-statefulset.yaml (lines 82-89)\n         heimdall/templates/heimdall-statefulset.yaml (no persistent volumes)\n\nIN PROGRESS:\n- None - clean state, ready for Phase 0\n\nGIT STATUS:\n- Branch: develop\n- Remote: origin/develop (up to date)\n- Last commit: ffa1e49 (refactor: Rename chart directory)\n- Working tree: CLEAN ✅\n- All changes committed and pushed ✅\n\nBEADS STATUS:\n- Total tasks: 24 (7 phases + 8 GitHub issues + 9 critical gaps)\n- Ready to work: 1 (Phase 0: Pre-Migration Baseline Testing)\n- Proper dependency chain: Phase 0 → 1 → 2 → 3 → 4 → 5 → 6 → 7\n- Command: bd ready\n\nNEXT STEPS (Phase 0 - Baseline Testing):\n1. Deploy current chart to local Kubernetes cluster\n2. Test persistence behavior (verify PostgreSQL PVC bug)\n3. Test Heimdall data persistence (does app need storage?)\n4. Export baseline database backup\n5. Document current behavior before modernization\n6. Create upgrade path test plan\n\nCRITICAL TASKS ADDED THIS SESSION:\n1. heimdall-helm-dhm: Phase 0 baseline testing (blocks Phase 1)\n2. heimdall-helm-0he: Debug StatefulSet PVC reconnection (CRITICAL)\n3. heimdall-helm-v7y: Research Sequelize migrations (NOT Rails)\n4. heimdall-helm-qwd: Verify health probe endpoints exist\n5. heimdall-helm-07c: Data migration strategy (standalone → Bitnami)\n6. heimdall-helm-ydy: Evaluate Bitnami readme-generator\n7. heimdall-helm-9f1: Investigate Issue #24 (may be intentional)\n8. heimdall-helm-9bk: CRITICAL - Verify DB vs App persistence\n\nBLOCKERS/NOTES:\n- User has local Kubernetes clusters for testing (ready for Phase 0)\n- Beads commands must run ONE AT A TIME (CLI bug - never chain)\n- Helm v4.0.0 released Nov 2025 - Chart API v2 compatible\n- Plan agent review identified 7 critical gaps + 15 medium enhancements\n- SESSION-*.md files now gitignored (internal only)\n- Model: Sonnet 4.5 (recommended for multi-phase architectural work)\n\nKEY FILES MODIFIED THIS SESSION:\n- .gitignore (enhanced with secrets, session files)\n- heimdall/.helmignore (NEW - chart packaging)\n- heimdall/* (all 14 files renamed from heimdall2/)\n- CLAUDE.md (structure updated)\n- PROJECT-STATUS.md (rename marked complete)\n- README.md (chart paths updated)\n- .beads/issues.jsonl (24 tasks, proper dependencies)\n\nPLAN AGENT KEY FINDINGS:\n- Issue #13: StatefulSet already exists but uses wrong PVC pattern\n- Issue #24: Password encoding may be intentional (SOPS integration)\n- Health endpoints may not exist (need verification)\n- Sequelize != Rails (different migration commands)\n- values.schema.json complexity underestimated (95+ env vars)\n- No upgrade/rollback testing strategy yet\n- PostgreSQL migration to Bitnami needs data migration plan\n\nRECOVERY INSTRUCTIONS:\n1. Run: bd ready\n2. Review Phase 0 task: heimdall-helm-dhm\n3. Read heimdall/templates/postgresql-statefulset.yaml (lines 82-89)\n4. Deploy to local cluster and test current persistence behavior\n5. Start baseline testing before any modernization work","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T12:17:32.872247-05:00","created_by":"alippold","updated_at":"2025-12-30T12:26:21.207376-05:00","closed_at":"2025-12-30T12:26:21.207376-05:00","close_reason":"Context restored, ready for Phase 0"}
{"id":"heimdall-helm-8yk","title":"Phase 4: Security \u0026 Configuration - CA certs, NetworkPolicy","status":"open","priority":0,"issue_type":"epic","created_at":"2025-12-30T11:39:15.758792-05:00","created_by":"alippold","updated_at":"2025-12-30T12:20:36.440236-05:00","dependencies":[{"issue_id":"heimdall-helm-8yk","depends_on_id":"heimdall-helm-2k8","type":"blocks","created_at":"2025-12-30T11:56:22.007758-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-9bk","title":"CRITICAL: Verify persistence - DB vs App - User reports possible backward config","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-30T12:03:36.166509-05:00","created_by":"alippold","updated_at":"2025-12-30T12:50:22.108859-05:00","closed_at":"2025-12-30T12:50:22.108859-05:00","close_reason":"Skipping baseline testing - rebuilding chart from scratch using Vulcan patterns. Old chart bugs are known, focus on building correctly.","dependencies":[{"issue_id":"heimdall-helm-9bk","depends_on_id":"heimdall-helm-dhm","type":"blocks","created_at":"2025-12-30T12:03:41.002484-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-9f1","title":"Investigate Issue #24 - Database password b64enc may be intentional (SOPS/external secrets)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T12:02:35.884148-05:00","created_by":"alippold","updated_at":"2025-12-30T16:41:20.882771-05:00","closed_at":"2025-12-30T16:41:20.882771-05:00","close_reason":"Investigation complete: Old secrets.yaml used data+b64enc, possibly for SOPS compatibility. New heimdall-secrets.yaml uses stringData which is cleaner and standard. SOPS users can still use heimdall.existingSecret to reference their SOPS-encrypted secret. No further action needed.","dependencies":[{"issue_id":"heimdall-helm-9f1","depends_on_id":"heimdall-helm-boh","type":"blocks","created_at":"2025-12-30T12:03:28.844716-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-ag8","title":"Fix GitHub Issue #29: Update init container to UBI 9","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T11:39:42.709089-05:00","created_by":"alippold","updated_at":"2025-12-30T11:39:42.709089-05:00","dependencies":[{"issue_id":"heimdall-helm-ag8","depends_on_id":"heimdall-helm-alv","type":"blocks","created_at":"2025-12-30T11:57:09.225231-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-alv","title":"Phase 2: Database \u0026 Persistence - Bitnami PostgreSQL, migrations","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-30T11:39:05.384024-05:00","created_by":"alippold","updated_at":"2025-12-31T00:20:53.310636-05:00","closed_at":"2025-12-31T00:20:53.310636-05:00","close_reason":"Phase 2 completed: Bitnami PostgreSQL integrated, migration job removed, database migrations documented","dependencies":[{"issue_id":"heimdall-helm-alv","depends_on_id":"heimdall-helm-boh","type":"blocks","created_at":"2025-12-30T11:56:12.447243-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-b3u","title":"RECOVERY: Session 5 Context","description":"Session 5 Summary - Heimdall Helm Chart Modernization\n\nCOMPLETED THIS SESSION:\n✅ Phase 1: Foundation (COMPLETE)\n  - Three-approach secrets management\n  - ConfigMap with envFrom pattern\n  - values.schema.json validation\n  - Database abstraction helpers\n  - Documentation (7 pages)\n\n✅ Phase 2: Bitnami PostgreSQL Integration (COMPLETE)\n  - Chart.yaml updated to v1.0.0 with Bitnami dependency (~18.2.0)\n  - Removed standalone PostgreSQL templates (3 files)\n  - Made all database config values-driven (no hardcoding)\n  - postgresql.auth.username configurable (default: postgres)\n  - postgresql.primary.service.ports.postgresql configurable (default: 5432)\n  - Updated helpers to use values instead of hardcoded strings\n  - Chart.lock committed for reproducible builds\n  - helm lint --strict: PASSED\n  - helm template: PASSED\n  - Commit: 7d6f41a\n\nCURRENT STATUS:\n- Chart version: 1.0.0 (new chart, breaking changes from v3.3.3)\n- Branch: develop\n- Working directory: /Users/alippold/github/mitre/heimdall-helm\n- All changes committed and synced\n\nPHASE 2 REMAINING WORK:\n- Init container for PostgreSQL readiness check\n- db-migrate-job.yaml for Sequelize migrations\n- Health probes (startup/liveness/readiness)\n\nCRITICAL LESSONS:\n- NEVER hardcode values - everything from values.yaml with defaults\n- ALWAYS stay in correct directory (/Users/alippold/github/mitre/heimdall-helm)\n- Close beads issues immediately when work completes\n- Test helm lint and helm template after every change\n- Chart.lock MUST be committed (use git add -f if needed)\n\nFILES MODIFIED THIS SESSION:\n- heimdall/Chart.yaml (v1.0.0, Bitnami dependency)\n- heimdall/values.yaml (PostgreSQL config, externalDatabase section)\n- heimdall/templates/_helpers.tpl (configurable database helpers)\n- docs/content/4.helm-chart/*.md (7 documentation pages)\n- Deleted: postgresql-*.yaml (3 standalone templates)\n- Created: heimdall/Chart.lock\n\nRECOVERY STEPS:\n1. cd /Users/alippold/github/mitre/heimdall-helm\n2. git status (verify on develop branch)\n3. bd list --status=in_progress\n4. Close this recovery card\n5. Continue with Phase 2 remaining work or Phase 3\n\nBEADS STATUS:\n- 28 total issues\n- Phase 1 epic: CLOSED\n- Phase 2 epic: IN_PROGRESS (heimdall-helm-alv)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T17:25:26.324775-05:00","created_by":"alippold","updated_at":"2025-12-30T18:29:28.098856-05:00","closed_at":"2025-12-30T18:29:28.098856-05:00","close_reason":"Context restored, continuing with Phase 2"}
{"id":"heimdall-helm-bb1","title":"RECOVERY: Current Session Context","description":"Context from 2025-12-30 Session 3:\n\nCOMPLETED THIS SESSION:\n- ✅ values.schema.json - Comprehensive validation for 95+ environment variables\n- ✅ Database abstraction helpers in _helpers.tpl (Vulcan patterns)\n- ✅ Updated heimdall-statefulset.yaml to use new helpers\n- ✅ Nuxt UI documentation site initialized with pnpm\n- ✅ Customized docs homepage (index.md) with proper u-page-section components\n- ✅ Configured app.config.ts with MITRE SAF branding\n- ✅ Created issue heimdall-helm-386 for GitLab auth bug #7542 (app-level fix)\n- ✅ Closed Phase 0 (skipped baseline testing - building from scratch)\n- ✅ All changes committed and pushed to develop branch\n\nIN PROGRESS:\n- Phase 1: Foundation (heimdall-helm-boh) - PARTIALLY COMPLETE\n  * Next: Implement three secrets approaches\n  * Then: Create generate-heimdall-secrets.sh script\n  * Remaining: Fix Issues #6, #22, #24\n\nGIT STATUS:\n- Branch: develop\n- Remote: up to date with origin/develop\n- Last commits:\n  * 6c25bd2: Phase 1 foundation (values.schema.json + helpers)\n  * cd1db1c: Nuxt UI docs site\n- Working tree: CLEAN (only .beads/.bdui/ untracked)\n\nBEADS STATUS:\n- Total: 26 issues (21 open, 1 in_progress, 4 closed)\n- Phase 1 epic (heimdall-helm-boh): in_progress\n- 0 tasks ready (all blocked by Phase 1 dependencies)\n- Issues created: heimdall-helm-386 (GitLab auth bug)\n\nFILES CREATED/MODIFIED THIS SESSION:\n- heimdall/values.schema.json (NEW - 574 lines)\n- heimdall/templates/_helpers.tpl (ADDED 80 lines database helpers)\n- heimdall/templates/heimdall-statefulset.yaml (USE new helpers)\n- heimdall/values.yaml (FIX imagePullSecrets validation)\n- docs/ (NEW - full Nuxt UI template with customizations)\n- .gitignore (UPDATED for docs build artifacts)\n\nNEXT STEPS (Phase 1 Continuation):\n1. Implement three secrets approaches in heimdall/templates/heimdall-secrets.yaml:\n   - Approach 1: existingSecret (production)\n   - Approach 2: secretsFiles (development - default)\n   - Approach 3: inline values (CI/CD)\n2. Create generate-heimdall-secrets.sh script (like Vulcan chart)\n3. Fix Issue #6 - duplicate host configuration in ingress\n4. Update Issue #22 status (values.schema.json complete)\n5. Investigate Issue #24 (may be intentional for SOPS)\n6. Write getting-started content pages for docs\n7. Add helm-docs README.md.gotmpl template\n\nCRITICAL CONTEXT:\n- Chart directory renamed: heimdall2/ → heimdall/ (session 2)\n- Using Vulcan chart as reference pattern throughout\n- Heimdall has 2 modes: Lite (no DB) and Server (with PostgreSQL)\n- Current chart only supports Server mode\n- Sequelize migrations (NOT Rails) - different syntax\n- PostgreSQL persistence bug: uses static PVC instead of volumeClaimTemplates\n- Always read docs/examples first, never guess (lesson learned)\n- Use MCPs: nuxt-ui-remote, context7, github\n\nREFERENCE DOCUMENTATION:\n- Vulcan chart: /Users/alippold/github/mitre/vulcan-helm\n- HEIMDALL-MIGRATION-PLAN.md - Complete modernization strategy\n- ISSUES-ANALYSIS.md - Analysis of 8 GitHub issues\n- Helm best practices: https://helm.sh/docs/chart_best_practices/\n- Nuxt UI template: https://github.com/nuxt-ui-templates/docs\n\nMODEL: Sonnet 4.5\nCONTEXT: ~55% remaining before this compact","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T16:03:01.356135-05:00","created_by":"alippold","updated_at":"2025-12-30T16:07:20.715047-05:00","closed_at":"2025-12-30T16:07:20.715047-05:00","close_reason":"Context restored, ready to continue Phase 1 secrets implementation"}
{"id":"heimdall-helm-boh","title":"Phase 1: Foundation - Chart structure, helpers, secrets","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-30T11:35:11.802431-05:00","created_by":"alippold","updated_at":"2025-12-30T16:44:10.642567-05:00","closed_at":"2025-12-30T16:44:10.642567-05:00","close_reason":"Phase 1 Foundation COMPLETE - All dependent tasks closed","dependencies":[{"issue_id":"heimdall-helm-boh","depends_on_id":"heimdall-helm-dhm","type":"blocks","created_at":"2025-12-30T12:02:42.617725-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-cyk","title":"RECOVERY: Current Session Context","description":"Context from 2025-12-31:\n\nCOMPLETED THIS SESSION:\n- ✅ Phase 4 Ingress: Refactored values.yaml and templates to industry standards\n  - Removed apiVersion/kind/backend from values (moved to template)\n  - Added className (default: traefik), annotations\n  - Kubernetes version detection (1.14+, 1.18+, 1.19+)\n  - Backward compatibility for older K8s\n- ✅ Created comprehensive documentation:\n  - docs/content/4.helm-chart/8.ingress.md (Traefik, Nginx, cloud LBs)\n  - docs/content/4.helm-chart/9.tls.md (cert-manager, DoD/MITRE certs)\n  - Updated NOTES.txt with ingress controller info\n- ✅ Research documents:\n  - INGRESS-TLS-RESEARCH.md (800+ lines best practices)\n  - INGRESS-COMPARISON.md (current vs best practices)\n- ✅ Commits pushed:\n  - 1ed9c34: feat(ingress): Refactor to industry best practices\n  - 433c499: docs: Add comprehensive ingress and TLS documentation\n\nIN PROGRESS:\n- Custom CA Certificates (heimdall-helm-6rg) - PARTIAL implementation\n  - Refactored values.yaml: certs → extraCertificates\n  - Updated templates (ConfigMap, StatefulSet)\n  - Chart LINTS successfully\n  - **ISSUE**: NODE_EXTRA_CA_CERTS expects FILE not DIRECTORY\n  - Need research on certificate handling approach\n\nGIT STATUS:\n- Branch: develop\n- Last pushed commit: 433c499\n- Uncommitted changes:\n  * M heimdall/values.yaml (extraCertificates structure)\n  * M heimdall/templates/heimdall-cacerts-configmap.yaml\n  * M heimdall/templates/heimdall-statefulset.yaml\n  * M .beads/issues.jsonl\n\nNEXT STEPS:\n1. Research NODE_EXTRA_CA_CERTS implementation:\n   - Review Node.js docs on certificate handling\n   - Check how other charts handle multiple CA certs\n   - Decide: concatenate to single file OR directory approach\n2. Complete Custom CA Certificates epic (3 tasks remaining)\n3. Test entire ingress/TLS/CA package in next session\n4. Consider Phase 3 (Health Probes) after CA work\n\nCRITICAL DECISIONS NEEDED:\n- Certificate file vs directory approach for NODE_EXTRA_CA_CERTS\n- Should we concatenate multiple certs into single file?\n- What about SSL_CERT_FILE and SSL_CERT_DIR env vars?\n\nBLOCKERS/NOTES:\n- At 70% context when compact called\n- Custom CA implementation needs deeper research\n- Don't revert changes - build on current work\n- All documentation is complete and synced\n\nFILES TO COMMIT (after research/fixes):\n1. heimdall/values.yaml (extraCertificates)\n2. heimdall/templates/heimdall-cacerts-configmap.yaml\n3. heimdall/templates/heimdall-statefulset.yaml","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-31T00:41:54.353893-05:00","created_by":"alippold","updated_at":"2025-12-31T00:49:13.242369-05:00","closed_at":"2025-12-31T00:49:13.242369-05:00","close_reason":"Restored context successfully. Researched and implemented NODE_EXTRA_CA_CERTS with concatenation approach."}
{"id":"heimdall-helm-dhm","title":"Phase 0: Pre-Migration Baseline Testing - Deploy v3.3.3, export data, document behavior","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-30T12:02:03.069413-05:00","created_by":"alippold","updated_at":"2025-12-30T12:50:22.106629-05:00","closed_at":"2025-12-30T12:50:22.106629-05:00","close_reason":"Skipping baseline testing - rebuilding chart from scratch using Vulcan patterns. Old chart bugs are known, focus on building correctly."}
{"id":"heimdall-helm-ey2","title":"Fix GitHub Issue #13: Allow reconnection to old PVs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T11:39:59.043151-05:00","created_by":"alippold","updated_at":"2025-12-31T00:20:55.864725-05:00","closed_at":"2025-12-31T00:20:55.864725-05:00","close_reason":"StatefulSet already handles PVC reconnection - no issue exists","dependencies":[{"issue_id":"heimdall-helm-ey2","depends_on_id":"heimdall-helm-alv","type":"blocks","created_at":"2025-12-30T11:57:03.53626-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-j4j","title":"RECOVERY: Current Session Context","description":"Context from 2025-12-30:\n\nCOMPLETED THIS SESSION:\n- Repository renamed: heimdall2-helm → heimdall-helm\n- Beads initialized with 15 tasks (7 phase epics + 8 GitHub issue tasks)\n- GitFlow develop branch created and pushed\n- Created comprehensive documentation:\n  * CLAUDE.md - Complete development guide\n  * HEIMDALL-MIGRATION-PLAN.md - Detailed modernization roadmap\n  * ISSUES-ANALYSIS.md - Best practices assessment vs all 8 GitHub issues\n  * PROJECT-STATUS.md - Current state summary\n  * SESSION-001.md - Session notes\n  * HELM-V4-NOTES.md - Helm v4 compatibility guide\n- All issues analyzed against official Helm best practices\n- Updated for Helm v4.0.0 compatibility (released Nov 2025)\n\nIN PROGRESS:\n- None - setup phase complete, ready to begin Phase 1\n\nGIT STATUS:\n- Branch: develop\n- Remote: origin/develop (pushed)\n- All documentation changes uncommitted\n- Working tree: New files created, not yet committed\n\nNEXT STEPS:\n1. Review bd ready to see all available tasks\n2. Start Phase 1 (heimdall-helm-boh): Foundation work\n   - Rename heimdall2/ → heimdall/ directory\n   - Create values.schema.json\n   - Enhance _helpers.tpl with database helpers\n   - Implement three secrets approaches\n3. Fix GitHub issues mapped to Phase 1:\n   - #22 (values.schema.json)\n   - #24 (stringData consistency)\n   - #6 (duplicate host)\n\nBLOCKERS/NOTES:\n- CRITICAL: Beads commands must run ONE AT A TIME (bug in beads CLI)\n- Helm v4.0.0 is released - we're targeting Chart API v2 (compatible with v3 \u0026 v4)\n- All Vulcan chart patterns documented in vulcan-helm/CLAUDE.md\n- GitLab OAuth bug needs investigation in Phase 5\n- Issue #13 (PV reconnection) is critical - data loss risk\n\nKEY REFERENCE FILES:\n- CLAUDE.md - Read this first for complete development workflow\n- HEIMDALL-MIGRATION-PLAN.md - Detailed phase-by-phase plan\n- PROJECT-STATUS.md - Quick status overview\n- vulcan-helm/CLAUDE.md - Pattern reference (Vulcan chart)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T11:46:31.095813-05:00","created_by":"alippold","updated_at":"2025-12-30T11:52:17.144453-05:00","closed_at":"2025-12-30T11:52:17.144453-05:00","close_reason":"Recovery successful, context fully restored"}
{"id":"heimdall-helm-jmn","title":"Phase 6: High Availability - PDB, HPA, multiple replicas","description":"Add HA configuration:\n- PodDisruptionBudget for safe rolling updates\n- HorizontalPodAutoscaler for auto-scaling\n- Support for multiple replicas (requires session affinity or shared sessions)\n- Anti-affinity rules for pod distribution\n- Resource requests/limits tuning","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-30T21:42:01.215165-05:00","created_by":"alippold","updated_at":"2025-12-30T21:42:01.215165-05:00"}
{"id":"heimdall-helm-o1m","title":"Fix GitHub Issue #22: Create values.schema.json validation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T11:39:53.733202-05:00","created_by":"alippold","updated_at":"2025-12-30T16:41:01.098802-05:00","closed_at":"2025-12-30T16:41:01.098802-05:00","close_reason":"COMPLETED in commit 6c25bd2: Created values.schema.json with comprehensive validation for 95+ environment variables using JSON Schema Draft-07","dependencies":[{"issue_id":"heimdall-helm-o1m","depends_on_id":"heimdall-helm-boh","type":"blocks","created_at":"2025-12-30T11:56:47.760962-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-opy","title":"Phase 4: Ingress - Support Nginx, Traefik, and cloud load balancers","description":"Add ingress configuration to values.yaml supporting:\n- Nginx Ingress Controller\n- Traefik\n- Cloud load balancers (AWS ALB, GCP GCLB, Azure App Gateway)\n- Configurable hostname, paths, annotations\n- IngressClass support","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-30T21:41:43.71247-05:00","created_by":"alippold","updated_at":"2025-12-30T21:41:43.71247-05:00"}
{"id":"heimdall-helm-opy.1","title":"Refactor values.yaml ingress section","description":"Remove apiVersion, kind, backend from values.yaml\nAdd className field (default: traefik)\nAdd annotations field (empty dict)\nChange enabled default from true to false\nUpdate host example from localhost to heimdall.local\nFix TLS structure (remove invalid 'name' field)\n\nReference: INGRESS-COMPARISON.md lines 12-40","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:16.379236-05:00","created_by":"alippold","updated_at":"2025-12-31T00:25:49.24933-05:00","closed_at":"2025-12-31T00:25:49.24933-05:00","close_reason":"Refactored values.yaml ingress section: removed apiVersion/kind/backend, added className (traefik default), added annotations, disabled by default, fixed TLS structure","dependencies":[{"issue_id":"heimdall-helm-opy.1","depends_on_id":"heimdall-helm-opy","type":"parent-child","created_at":"2025-12-31T00:21:16.384527-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-opy.2","title":"Document Traefik configuration examples","description":"Add Traefik examples to chart README or docs/\n- Basic HTTP ingress\n- HTTPS with cert-manager\n- Common Traefik annotations\n- Session affinity configuration\n\nTraefik is the PRIMARY example (default)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:34.8806-05:00","created_by":"alippold","updated_at":"2025-12-31T00:27:07.653248-05:00","closed_at":"2025-12-31T00:27:07.653248-05:00","close_reason":"Created ingress.yaml template with K8s version detection (1.14+, 1.18+, 1.19+), className support, backward compatibility, dynamic service name/port","dependencies":[{"issue_id":"heimdall-helm-opy.2","depends_on_id":"heimdall-helm-opy","type":"parent-child","created_at":"2025-12-31T00:21:34.885173-05:00","created_by":"daemon"},{"issue_id":"heimdall-helm-opy.2","depends_on_id":"heimdall-helm-opy.1","type":"blocks","created_at":"2025-12-31T00:22:51.178202-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-opy.3","title":"Document Nginx configuration examples","description":"Add Nginx examples to chart README or docs/\n- Basic HTTP ingress  \n- HTTPS with cert-manager\n- Common Nginx annotations\n- Proxy settings\n\nNginx is SECONDARY example (for compatibility)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:34.972448-05:00","created_by":"alippold","updated_at":"2025-12-31T00:31:27.928899-05:00","closed_at":"2025-12-31T00:31:27.928899-05:00","close_reason":"Nginx examples already documented in docs/content/4.helm-chart/8.ingress.md (see 'Nginx Ingress Controller' section with common annotations)","dependencies":[{"issue_id":"heimdall-helm-opy.3","depends_on_id":"heimdall-helm-opy","type":"parent-child","created_at":"2025-12-31T00:21:34.973345-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-opy.4","title":"Update NOTES.txt with ingress access instructions","description":"Add ingress conditional section to NOTES.txt\nShow ingress URL when enabled\nShow both HTTP and HTTPS based on TLS config\nReference existing service type conditionals (NodePort, LoadBalancer, ClusterIP)\n\nPattern already exists at lines 21-62","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:35.053963-05:00","created_by":"alippold","updated_at":"2025-12-31T00:30:45.105002-05:00","closed_at":"2025-12-31T00:30:45.105002-05:00","close_reason":"Updated NOTES.txt with ingress controller display, kubectl verify command, controller-specific notes (Traefik/Nginx retirement warning)","dependencies":[{"issue_id":"heimdall-helm-opy.4","depends_on_id":"heimdall-helm-opy","type":"parent-child","created_at":"2025-12-31T00:21:35.054813-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-opy.5","title":"Test ingress with kind cluster (Traefik + Nginx)","description":"Create kind cluster\nInstall Traefik ingress controller\nInstall chart with ingress.className=traefik\nVerify ingress created and accessible\nRepeat with Nginx ingress controller\nDocument test procedure","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:35.134498-05:00","created_by":"alippold","updated_at":"2025-12-31T00:21:35.134498-05:00","dependencies":[{"issue_id":"heimdall-helm-opy.5","depends_on_id":"heimdall-helm-opy","type":"parent-child","created_at":"2025-12-31T00:21:35.135477-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-pow","title":"Fix GitHub Issue #24: Move database password to stringData section","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T11:39:48.381033-05:00","created_by":"alippold","updated_at":"2025-12-30T16:41:07.353685-05:00","closed_at":"2025-12-30T16:41:07.353685-05:00","close_reason":"COMPLETED in commit 5d1bd84: New heimdall-secrets.yaml uses stringData (not data with b64enc) for all secret values. Much cleaner than old approach.","dependencies":[{"issue_id":"heimdall-helm-pow","depends_on_id":"heimdall-helm-boh","type":"blocks","created_at":"2025-12-30T11:56:52.934649-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-pp6","title":"Phase 6: Documentation \u0026 Testing - Nuxt docs, Helm tests","status":"open","priority":0,"issue_type":"epic","created_at":"2025-12-30T11:39:25.790653-05:00","created_by":"alippold","updated_at":"2025-12-30T12:20:47.583989-05:00","dependencies":[{"issue_id":"heimdall-helm-pp6","depends_on_id":"heimdall-helm-7ww","type":"blocks","created_at":"2025-12-30T11:56:31.252693-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-qwd","title":"Verify Heimdall health probe endpoints exist (/api/v1/health, /api/v1/ping, etc.)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T12:02:19.160772-05:00","created_by":"alippold","updated_at":"2025-12-31T09:46:23.102712-05:00","closed_at":"2025-12-31T09:46:23.102712-05:00","close_reason":"Research complete: Heimdall doesn't have dedicated health endpoints. Using root path '/' is appropriate. App returns 200 when running.","dependencies":[{"issue_id":"heimdall-helm-qwd","depends_on_id":"heimdall-helm-2k8","type":"blocks","created_at":"2025-12-30T12:03:11.590843-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-ug0","title":"RECOVERY: Current Session Context","description":"Context from 2025-12-30:\n\nCOMPLETED THIS SESSION:\n- ✅ Removed redundant database migration job (db-migrate-job.yaml)\n- ✅ Research: Helm migration job best practices vs app-based migrations\n- ✅ Discovered Heimdall runs migrations in cmd.sh (yarn backend sequelize-cli db:migrate)\n- ✅ Created comprehensive research doc (MIGRATION-JOB-RESEARCH.md - 800+ lines)\n- ✅ Created user documentation (docs/content/4.helm-chart/database-migrations.md)\n- ✅ Updated CHANGELOG with breaking change notice\n- ✅ Removed heimdall.dbMigrate.* configuration from values.yaml\n- ✅ Committed and pushed: feat(phase2)!: Remove redundant database migration job (commit 4aecb49)\n- ✅ Created NOTES.txt template following Helm best practices\n- ✅ Fixed .helmignore to include NOTES.txt (removed *.txt exclusion)\n- ✅ Made NOTES.txt fully dynamic (no hardcoded values)\n- ✅ Tested NOTES.txt - displays correctly on helm install/upgrade\n\nIN PROGRESS:\n- NOTES.txt created but not yet committed\n\nGIT STATUS:\n- Branch: develop\n- Last commit: 4aecb49 (feat(phase2)!: Remove redundant database migration job)\n- Uncommitted changes:\n  * M heimdall/.helmignore (removed *.txt, added comment about NOTES.txt)\n  * ?? heimdall/templates/NOTES.txt (new file - dynamic password/email display)\n\nDEPLOYMENT STATUS:\n- Heimdall running: 1/1 Ready (namespace: heimdall)\n- PostgreSQL running: 1/1 Running\n- Port-forward active: localhost:8080\n- All migrations completed successfully (28 migrations)\n- Default credentials working: admin@heimdall.local / Admin_68dd3f7fa7c7efd32cbeda1b6fe00afa\n\nNEXT STEPS:\n1. Commit NOTES.txt and .helmignore changes\n2. Research questions:\n   - Best practices for displaying default password to users\n   - OAuth/OIDC configuration helpers in Helm charts\n   - Ingress configuration patterns (Nginx, Traefik, cloud LBs)\n   - TLS/SSL with cert-manager integration\n3. Review beads board for next priorities\n4. Tackle Phase 3+ work (Health Probes, Ingress, TLS, OAuth fixes)\n\nCRITICAL DECISIONS MADE:\n- Removed migration job: Heimdall's architecture runs migrations on startup (cmd.sh)\n- Matches Node.js/Sequelize ecosystem (Ghost, Directus, Strapi)\n- Sequelize handles idempotency via SequelizeMeta table\n- NOTES.txt follows Bitnami/Grafana/WordPress patterns\n- Admin credentials pulled dynamically from ConfigMap/Secret\n\nOPEN QUESTIONS FOR NEXT SESSION:\n- How to structure OAuth/OIDC configuration in values.yaml?\n- Should we create a dedicated card for NOTES.txt improvements?\n- What's the best practice for password display in Helm charts?\n- GitLab OAuth bug (heimdall-helm-386) - when to tackle?\n\nFILES TO COMMIT:\n1. heimdall/templates/NOTES.txt (new)\n2. heimdall/.helmignore (modified - removed *.txt exclusion)\n\nBLOCKERS/NOTES:\n- None currently\n- Pod had 2 restarts on fresh install (PostgreSQL not ready) - Phase 3 issue\n- Ingress shows \"http://localhost/\" when enabled (values.yaml has host: localhost)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T19:10:50.01781-05:00","created_by":"alippold","updated_at":"2025-12-30T23:56:23.857027-05:00","closed_at":"2025-12-30T23:56:23.857027-05:00","close_reason":"Context recovered, NOTES.txt work completed and committed (f739e90)"}
{"id":"heimdall-helm-v7y","title":"Research Heimdall Sequelize migration commands (NOT Rails - different syntax)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-30T12:02:13.698767-05:00","created_by":"alippold","updated_at":"2025-12-31T00:20:54.567353-05:00","closed_at":"2025-12-31T00:20:54.567353-05:00","close_reason":"No longer relevant - migration job removed, using app-based migrations","dependencies":[{"issue_id":"heimdall-helm-v7y","depends_on_id":"heimdall-helm-alv","type":"blocks","created_at":"2025-12-30T12:02:53.631796-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-wyl","title":"Fix GitHub Issue #6: Remove duplicate host configuration in ingress","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-30T11:40:15.359734-05:00","created_by":"alippold","updated_at":"2025-12-30T16:44:02.890644-05:00","closed_at":"2025-12-30T16:44:02.890644-05:00","close_reason":"Issue #6 is obsolete. Original complaint was about duplicate host config on 'line 124' in old chart. Current ingress.yaml is only 39 lines and follows standard Helm patterns with no duplication. Issue from 2023, chart has been completely refactored since then.","dependencies":[{"issue_id":"heimdall-helm-wyl","depends_on_id":"heimdall-helm-boh","type":"blocks","created_at":"2025-12-30T11:56:58.121367-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-xe1","title":"Create upstream PR: Add @nestjs/terminus health endpoints to Heimdall2","description":"Submit PR to mitre/heimdall2 repository to add proper health check endpoints:\n- Install @nestjs/terminus\n- Create /health/liveness endpoint (app running)\n- Create /health/readiness endpoint (app + database ready)\n- Create /health/startup endpoint (migrations complete)\nThis will enable better Kubernetes health probes in future chart versions.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-31T09:46:43.342375-05:00","created_by":"alippold","updated_at":"2025-12-31T09:46:43.342375-05:00"}
{"id":"heimdall-helm-xta","title":"Phase 5: TLS/SSL - cert-manager integration and manual cert support","description":"Add TLS configuration:\n- cert-manager integration for automatic certs (Let's Encrypt)\n- Manual certificate upload support\n- TLS secret configuration\n- HTTPS redirect options\n- Certificate annotations for cloud providers","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-30T21:41:53.134244-05:00","created_by":"alippold","updated_at":"2025-12-30T21:41:53.134244-05:00"}
{"id":"heimdall-helm-xta.1","title":"Document cert-manager integration (Let's Encrypt)","description":"Document cert-manager installation\nCreate ClusterIssuer examples (staging + production)\nShow ingress annotation: cert-manager.io/cluster-issuer\nDocument automatic certificate creation\nInclude renewal workflow\n\nReference: INGRESS-TLS-RESEARCH.md section 2","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:59.27536-05:00","created_by":"alippold","updated_at":"2025-12-31T00:30:46.405271-05:00","closed_at":"2025-12-31T00:30:46.405271-05:00","close_reason":"Created comprehensive ingress and TLS documentation (8.ingress.md, 9.tls.md) covering cert-manager, DoD/MITRE certs, and all ingress controllers","dependencies":[{"issue_id":"heimdall-helm-xta.1","depends_on_id":"heimdall-helm-xta","type":"parent-child","created_at":"2025-12-31T00:21:59.279958-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-xta.2","title":"Document DoD/MITRE manual certificate workflow","description":"Document creating TLS secret manually:\nkubectl create secret tls heimdall-tls --cert=dod.crt --key=dod.key\n\nShow how to reference in values.yaml:\ningress.tls[0].secretName: heimdall-tls\n\nInclude certificate renewal procedure\nDocument certificate format requirements (.crt, .pem)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:59.373652-05:00","created_by":"alippold","updated_at":"2025-12-31T00:30:46.407936-05:00","closed_at":"2025-12-31T00:30:46.407936-05:00","close_reason":"Created comprehensive ingress and TLS documentation (8.ingress.md, 9.tls.md) covering cert-manager, DoD/MITRE certs, and all ingress controllers","dependencies":[{"issue_id":"heimdall-helm-xta.2","depends_on_id":"heimdall-helm-xta","type":"parent-child","created_at":"2025-12-31T00:21:59.374729-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-xta.3","title":"Document corporate CA certificate workflow","description":"Document corporate CA bundle creation\nSame kubectl create secret tls pattern\nInclude chain certificate handling\nDocument common corporate CA scenarios","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:59.46819-05:00","created_by":"alippold","updated_at":"2025-12-31T00:30:46.410451-05:00","closed_at":"2025-12-31T00:30:46.410451-05:00","close_reason":"Created comprehensive ingress and TLS documentation (8.ingress.md, 9.tls.md) covering cert-manager, DoD/MITRE certs, and all ingress controllers","dependencies":[{"issue_id":"heimdall-helm-xta.3","depends_on_id":"heimdall-helm-xta","type":"parent-child","created_at":"2025-12-31T00:21:59.469369-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-xta.4","title":"Add TLS examples to NOTES.txt","description":"Add TLS verification commands to NOTES.txt\nShow how to verify certificate:\nkubectl get secret heimdall-tls -o yaml\n\nShow cert-manager certificate status:\nkubectl get certificate -n heimdall\n\nInclude HTTPS URL when TLS enabled","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:59.566086-05:00","created_by":"alippold","updated_at":"2025-12-31T00:31:29.31672-05:00","closed_at":"2025-12-31T00:31:29.31672-05:00","close_reason":"TLS examples already in NOTES.txt (lines 84-97 show TLS warnings and cert-manager references)","dependencies":[{"issue_id":"heimdall-helm-xta.4","depends_on_id":"heimdall-helm-xta","type":"parent-child","created_at":"2025-12-31T00:21:59.567746-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-xta.5","title":"Test with cert-manager staging issuer","description":"Install cert-manager in test cluster\nCreate staging ClusterIssuer\nDeploy chart with cert-manager annotation\nVerify certificate creation\nTest HTTPS access\nDocument test procedure","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-31T00:21:59.674708-05:00","created_by":"alippold","updated_at":"2025-12-31T00:21:59.674708-05:00","dependencies":[{"issue_id":"heimdall-helm-xta.5","depends_on_id":"heimdall-helm-xta","type":"parent-child","created_at":"2025-12-31T00:21:59.675949-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-ydy","title":"Evaluate Bitnami readme-generator-for-helm for automated README.md","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T12:02:30.626112-05:00","created_by":"alippold","updated_at":"2025-12-30T12:02:30.626112-05:00","dependencies":[{"issue_id":"heimdall-helm-ydy","depends_on_id":"heimdall-helm-pp6","type":"blocks","created_at":"2025-12-30T12:03:19.987955-05:00","created_by":"daemon"}]}
{"id":"heimdall-helm-z1m","title":"Fix GitHub Issue #8: Update documentation","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T11:40:09.559065-05:00","created_by":"alippold","updated_at":"2025-12-30T11:40:09.559065-05:00","dependencies":[{"issue_id":"heimdall-helm-z1m","depends_on_id":"heimdall-helm-pp6","type":"blocks","created_at":"2025-12-30T11:57:20.00372-05:00","created_by":"daemon"}]}
