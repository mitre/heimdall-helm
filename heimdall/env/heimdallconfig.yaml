# =============================================================================
# Heimdall Non-Sensitive Configuration
# =============================================================================
# This file contains non-sensitive environment variables for Heimdall Server.
# Sensitive credentials (passwords, secrets, keys) belong in heimdall-secrets.yaml
# (which is gitignored and auto-generated by generate-heimdall-secrets.sh)

# =============================================================================
# Node.js Environment
# =============================================================================
# NODE_ENV is managed by configmap.yaml template (set via values.nodeEnv)
# Do NOT add NODE_ENV here - it will create duplicate keys

# =============================================================================
# Database Configuration (SSL/TLS Settings Only)
# =============================================================================
# Database connection details (HOST, PORT, NAME, USERNAME) are set by template
# helpers in configmap.yaml to handle embedded vs external PostgreSQL properly.
# Database credentials (PASSWORD) are in secrets, not here.
DATABASE_SSL: "false"
DATABASE_SSL_INSECURE: "false"

# =============================================================================
# JWT Configuration
# =============================================================================
JWT_EXPIRE_TIME: "25m"  # Session timeout (25 minutes default)
# JWT_SECRET is in heimdall-secrets.yaml (must be 64+ chars)

# =============================================================================
# Admin User Configuration
# =============================================================================
ADMIN_EMAIL: "admin@heimdall.local"
ADMIN_USES_EXTERNAL_AUTH: "false"  # Set to true if admin uses OAuth/OIDC
# ADMIN_PASSWORD is in heimdall-secrets.yaml

# =============================================================================
# Authentication Configuration
# =============================================================================
LOCAL_LOGIN_DISABLED: "false"      # Allow local username/password login
REGISTRATION_DISABLED: "false"     # Allow new user self-registration
ONE_SESSION_PER_USER: "false"      # Allow multiple concurrent sessions

# =============================================================================
# Upload Configuration
# =============================================================================
MAX_FILE_UPLOAD_SIZE: "50"  # Megabytes (adjust for large evaluation files)

# =============================================================================
# Classification Banner Configuration
# =============================================================================
CLASSIFICATION_BANNER_TEXT: ""  # e.g., "UNCLASSIFIED", "SECRET", etc.
CLASSIFICATION_BANNER_TEXT_COLOR: "white"
CLASSIFICATION_BANNER_COLOR: "red"

# =============================================================================
# Proxy Configuration (For Air-Gapped Environments)
# =============================================================================
HTTPS_PROXY: ""  # e.g., "http://proxy.example.com:8080"

# =============================================================================
# External Integrations (Optional - URLs Only)
# =============================================================================
TENABLE_HOST_URL: ""    # Tenable.io integration
SPLUNK_HOST_URL: ""     # Splunk integration
# Integration secrets (API tokens) go in heimdall-secrets.yaml

# =============================================================================
# OAuth/OIDC Configuration (URLs and Non-Sensitive Settings)
# =============================================================================
# Secrets go in heimdall-secrets.yaml
# External URL is set via ingress or service configuration

# -----------------------------------------------------------------------------
# GitHub OAuth
# -----------------------------------------------------------------------------
# CRITICAL: Heimdall expects GITHUB_CLIENTID (one underscore)
# See: apps/backend/src/config/config.service.ts:enabledOauthStrategies()
# Code: this.get(`${oauthStrategy.toUpperCase()}_CLIENTID`)
GITHUB_CLIENTID: ""
GITHUB_ENTERPRISE_INSTANCE_BASE_URL: ""  # For GitHub Enterprise
GITHUB_ENTERPRISE_INSTANCE_API_URL: ""
# GITHUB_CLIENTSECRET is in heimdall-secrets.yaml (no underscore before SECRET)

# -----------------------------------------------------------------------------
# GitLab OAuth
# -----------------------------------------------------------------------------
# CRITICAL: Heimdall expects GITLAB_CLIENTID (one underscore) for ID
# WARNING: GitLab uses GITLAB_SECRET (not CLIENTSECRET) - Heimdall inconsistency
GITLAB_CLIENTID: ""
GITLAB_BASEURL: "https://gitlab.com"  # Or your GitLab instance URL
# GITLAB_SECRET is in heimdall-secrets.yaml

# -----------------------------------------------------------------------------
# Google OAuth
# -----------------------------------------------------------------------------
# CRITICAL: Heimdall expects GOOGLE_CLIENTID (one underscore)
GOOGLE_CLIENTID: ""
# GOOGLE_CLIENTSECRET is in heimdall-secrets.yaml (no underscore before SECRET)

# -----------------------------------------------------------------------------
# Okta OAuth/OIDC
# -----------------------------------------------------------------------------
# CRITICAL: Heimdall expects OKTA_CLIENTID (one underscore)
OKTA_DOMAIN: ""  # e.g., "example.okta.com"
OKTA_ISSUER_URL: ""  # e.g., "https://example.okta.com/oauth2/default"
OKTA_CLIENTID: ""
OKTA_AUTHORIZATION_URL: ""
OKTA_TOKEN_URL: ""
OKTA_USER_INFO_URL: ""
OKTA_USE_HTTPS_PROXY: "false"
# OKTA_CLIENTSECRET is in heimdall-secrets.yaml (no underscore before SECRET)

# -----------------------------------------------------------------------------
# Generic OIDC Provider
# -----------------------------------------------------------------------------
# CRITICAL: Heimdall expects OIDC_CLIENTID (one underscore) for ID
# WARNING: OIDC uses OIDC_CLIENT_SECRET (has underscore) - Heimdall inconsistency
OIDC_NAME: "OIDC Provider"  # Display name for login button
OIDC_ISSUER: ""  # e.g., "https://auth.example.com"
OIDC_CLIENTID: ""
OIDC_AUTHORIZATION_URL: ""
OIDC_TOKEN_URL: ""
OIDC_USER_INFO_URL: ""
OIDC_USES_PKCE_PLAIN: "false"
OIDC_USES_PKCE_S256: "false"
OIDC_USES_VERIFIED_EMAIL: "false"
OIDC_EXTERNAL_GROUPS: "false"
OIDC_USE_HTTPS_PROXY: "false"
# OIDC_CLIENT_SECRET is in heimdall-secrets.yaml (has underscore before SECRET)

# -----------------------------------------------------------------------------
# LDAP Configuration
# -----------------------------------------------------------------------------
LDAP_ENABLED: "false"
LDAP_HOST: "ldap.example.com"
LDAP_PORT: "389"
LDAP_SEARCHBASE: "dc=example,dc=com"
LDAP_SEARCHFILTER: "(uid={{username}})"
LDAP_NAMEFIELD: "cn"      # LDAP attribute for user's full name
LDAP_MAILFIELD: "mail"    # LDAP attribute for user's email
LDAP_SSL: "false"
LDAP_SSL_INSECURE: "false"
# LDAP_BINDDN and LDAP_PASSWORD are in heimdall-secrets.yaml
# LDAP_SSL_CA is in heimdall-secrets.yaml (if using SSL with custom CA)

# =============================================================================
# Feature Flags
# =============================================================================
FORCE_TENABLE_FRONTEND: "false"  # Force Tenable-specific UI features

# =============================================================================
# Notes
# =============================================================================
# - All sensitive values (passwords, secrets, tokens) MUST be in heimdall-secrets.yaml
# - Generate secrets with: ./generate-heimdall-secrets.sh
# - For production with External Secrets Operator, set heimdall.existingSecret
# - For CI/CD, use heimdall.secrets in values.yaml
# - External URL is constructed from ingress/service configuration
